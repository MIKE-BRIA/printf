The actual working implementation of thefunction
